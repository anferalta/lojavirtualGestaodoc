{% extends "layouts/painel.twig" %}

{% block title %}Documentos{% endblock %}

{% block content %}

<div class="page-header">
    <h1 class="page-title">Documentos</h1>

    {% if can('documentos.criar') %}
        <a href="{{ url('/documentos/criar') }}" class="btn-primary">
            Carregar documento
        </a>
    {% endif %}
</div>

<div class="table-wrapper">
    <table class="modern-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>TÃ­tulo</th>
                <th>DescriÃ§Ã£o</th>
                <th>Carregado por</th>
                <th>Estado</th>
                <th style="width: 180px;">AÃ§Ãµes</th>
            </tr>
        </thead>

        <tbody>
            {% for doc in documentos %}
                <tr>
                    <td>{{ doc.id }}</td>

                    <td>{{ doc.titulo }}</td>

                    <td>
                        {{ doc.descricao ?: 'â€”' }}
                    </td>

                    <td>
                        {{ doc.owner_id ?: 'â€”' }}
                    </td>

                    <td>
                        {% if doc.estado == 'ativo' %}
                            <span class="badge badge-success">Ativo</span>
                        {% else %}
                            <span class="badge badge-danger">Inativo</span>
                        {% endif %}
                    </td>

                    <td style="display:flex; gap:6px;">

                        {# ðŸ”¥ DOWNLOAD SEGURO (ACL) #}
                        {% if can('documentos.ver') %}
                            <a href="{{ url('/documentos/download/' ~ doc.id) }}"
                               class="btn-sm btn-primary">
                                Download
                            </a>
                        {% endif %}

                        {# ðŸ”¥ EDITAR #}
                        {% if can('documentos.editar') %}
                            <a href="{{ url('/documentos/editar/' ~ doc.id) }}"
                               class="btn-sm btn-warning">
                                Editar
                            </a>
                        {% endif %}

                        {# ðŸ”¥ APAGAR #}
                        {% if can('documentos.eliminar') %}
                            <form method="post"
                                  action="{{ url('/documentos/eliminar/' ~ doc.id) }}"
                                  onsubmit="return confirm('Tem a certeza que deseja eliminar este documento?');">

                                <input type="hidden" name="_csrf" value="{{ csrf }}">

                                <button class="btn-sm btn-danger">
                                    Eliminar
                                </button>
                            </form>
                        {% endif %}

                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="6" style="text-align:center; padding:20px;">
                        Nenhum documento encontrado.
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}