{% extends "layout.twig" %}

{% block content %}
<div class="container mt-4">
    <h1>Editar Perfil</h1>

    <form method="post" action="{{ url('/perfis/update/' ~ perfil.id) }}">
        <input type="hidden" name="_csrf" value="{{ csrf }}">

        <div class="mb-3">
            <label>Nome</label>
            <input type="text" name="nome" class="form-control"
                   value="{{ perfil.nome }}">
            {% if errors.nome %}
                <small class="text-danger">{{ errors.nome[0] }}</small>
            {% endif %}
        </div>

        <div class="mb-3">
            <label>Descrição</label>
            <textarea name="descricao" class="form-control">{{ perfil.descricao }}</textarea>
        </div>

        <div class="mb-3">
            <label>Estado</label>
            <select name="estado" class="form-select">
                <option value="ativo"   {% if perfil.estado == 'ativo' %}selected{% endif %}>Ativo</option>
                <option value="inativo" {% if perfil.estado == 'inativo' %}selected{% endif %}>Inativo</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Permissões</label>
            <div class="row">
                {% for perm in permissoes %}
                <div class="col-md-4">
                    <label>
                        <input type="checkbox" name="permissoes[]" value="{{ perm.id }}"
                               {% if perm.id in permissoesAtivas %}checked{% endif %}>
                        {{ perm.chave }}
                    </label>
                </div>
                {% endfor %}
            </div>
        </div>

        <button class="btn btn-primary">Guardar</button>
        <a href="{{ url('/perfis') }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}